<template id="wwe-close-button">
	<style>
		@import "/modules/wwi/component/design/css/attr.css";
		:host{

			--background-color: transparent;
			--border-color:transparent;
			--shadow-color:rgba(0,0,0,0.3);
			--color: rgba(39, 39, 39, 0.7);

			--active-background-color: var(--berry);
			--active-color:white;

			border-radius: 100px;
			box-shadow:0 0 0 2px var(--border-color);

			cursor: pointer;
			color:var(--color);

			font-size: 14px;
			font-weight: 400;

			height: 18px;

			line-height: 18px;

			outline:none;
			overflow: hidden;

			text-align: center;
			touch-action: none;
			transition: background 200ms ease;

			width: 18px;
			will-change: background;
			background-color: var(--background-color);
		}

		/*borders*/
		:host([border]){
			--border-color:white;
		}
		:host([shadow]){
			box-shadow:0 0 0 2px var(--border-color),0 0 10px var(--shadow-color);
		}

		:host(:hover),
		:host(:focus) {
			background-color:var(--active-background-color);
			color:var(--active-color);
		}

		/*themes*/
		:host([red]){
			--background-color: #f65371;
			--color: #692538;
		}
		:host([red]:hover),
		:host([red]:focus) {
			background-color:var(--active-background-color);
			color:var(--color);
		}
		:host([red]:active){
			background-color:var(--active-background-color);
			color:var(--active-color);
		}

		/*corner position*/
		:host([corner]){
			position: absolute;
		}
		:host([corner-x="right"]){
			right: 5px;
		}
		:host([corner-x="left"]){
			left: 5px;
		}
		:host([corner-y="top"]){
			top: 5px;
		}
		:host([corner-y="bottom"]){
			bottom: 5px;
		}

		/*icon style*/
		[x-icon] {
			cursor: pointer;
			display: block;
			margin:0 auto;
		}

		:host([red]) [x-icon],
		:host([animate]) [x-icon]{
			opacity: 0;
			transform: scale(0, 0);
			transform-origin: center center;
			transform-style: flat;

			transition-duration: 200ms;
			transition-property: opacity, transform;
			transition-timing-function: ease;
			will-change: opacity, transform;
		}

		:host([red]:hover) [x-icon] {
			opacity: 1;
			transform: scale(1, 1);
		}

		:host([red]:focus) [x-icon] {
			opacity: 1;
			transform: scale(1, 1);
		}

	</style>

	<div x-icon>&#10005;</div>

</template>
<script>
	((doc)=>{
		const CloseButton = wwi.button(doc)
		CloseButton(class extends CloseButton.Element{
			constructor(){
				super('routes',{
					tap:true,
					xy(){ return set_corner(this) },
					corner(){ return set_corner(this) }
				})
			}
			tapped(e){
				if(this.tap){
					let tap = this.on.act(this.tap)
					if(tap) tap.action(e)
				}
				else this.dispatch('close')
			}
			a11y_connected(ally){
				ally.on('keypress',e=>{ if(e.key.activates) this.tapped(e) })
				if(!this.onclick) ally.on('click',e=>this.tapped(e))
			}
		})

		//shared actions

		function get_xy(value){
			value = fxy.in(value)
			if(value.length === 1) value[1] = value[0]
			return value.map(item=>fxy.numeral(item))
		}

		function set_corner(element){
			let corners = set_corner_value(element,element.corner)
			let xy = get_xy(element.xy)
			return set_corner_offset(element,xy,corners)
		}

		function set_corner_offset(element,xy,corners){
			for(let i in xy){
				let value = xy[i]
				if(!value.unit) value.unit = 'px'
				switch(i){
					case 0:
					case '0':
						element.style[corners.x || 'left'] = `${value}`
						break
					case 1:
					case '1':
						element.style[corners.y || 'top'] = `${value}`
						break

				}
			}
		}

		function set_corner_value(element,value){
			let corners =  fxy.in(value)
			let data = {}
			for(let corner of corners){
				if(corner === 'left' || corner === 'right'){
					element.setAttribute('corner-x',corner)
					data.x = corner
				}
				else if(corner==='top' || corner === 'bottom'){
					element.setAttribute('corner-y',corner)
					data.y = corner
				}
			}
			return data
		}
	})(document)
</script>

